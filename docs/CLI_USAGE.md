# AeroLOPA Crawler CLI ä½¿ç”¨æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ AeroLOPA Crawler çš„å‘½ä»¤è¡Œç•Œé¢è¿›è¡Œæ‰¹é‡åº§ä½å›¾æŠ“å–ã€‚

## ğŸ“‹ ç›®å½•
- [æ¦‚è¿°](#æ¦‚è¿°)
- [åŸºæœ¬ç”¨æ³•](#åŸºæœ¬ç”¨æ³•)
- [è¯¦ç»†ä½¿ç”¨ç¤ºä¾‹](#è¯¦ç»†ä½¿ç”¨ç¤ºä¾‹)
- [è¾“å‡ºç»“æ„è¯¦è§£](#è¾“å‡ºç»“æ„è¯¦è§£)
- [é«˜çº§åŠŸèƒ½](#é«˜çº§åŠŸèƒ½)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
- [é›†æˆç¤ºä¾‹](#é›†æˆç¤ºä¾‹)
- [æ›´å¤šä¿¡æ¯](#æ›´å¤šä¿¡æ¯)

## æ¦‚è¿°

AeroLOPA Crawler æä¾›äº†å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒæ‰¹é‡æŠ“å–èˆªç©ºå…¬å¸åº§ä½å›¾æ•°æ®ã€‚é€šè¿‡ `main.py` å…¥å£æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°æŠ“å–å•ä¸ªæˆ–å¤šä¸ªèˆªç©ºå…¬å¸çš„åº§ä½å›¾ã€‚

## åŸºæœ¬ç”¨æ³•

### å…¥å£æ–‡ä»¶

```bash
python main.py [é€‰é¡¹]
```

### å‘½ä»¤è¡Œé€‰é¡¹

| é€‰é¡¹ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `--airline <code>` | æŠ“å–æŒ‡å®šèˆªç©ºå…¬å¸çš„åº§ä½å›¾ | `--airline AA` |
| `--all-airlines` | æŠ“å–æ‰€æœ‰æ”¯æŒçš„èˆªç©ºå…¬å¸ | `--all-airlines` |
| `--list-airlines` | åˆ—å‡ºæ‰€æœ‰æ”¯æŒçš„èˆªç©ºå…¬å¸ä»£ç  | `--list-airlines` |
| `--verbose` | æ˜¾ç¤ºè¯¦ç»†çš„æŠ“å–è¿‡ç¨‹ä¿¡æ¯ | `--verbose` |
| `--output-dir <path>` | æŒ‡å®šè¾“å‡ºç›®å½•ï¼ˆé»˜è®¤ï¼šdata/ï¼‰ | `--output-dir ./output` |
| `--stats` | æ˜¾ç¤ºæŠ“å–ç»Ÿè®¡ä¿¡æ¯ | `--stats` |

## è¯¦ç»†ä½¿ç”¨ç¤ºä¾‹

### 1. æŠ“å–å•ä¸ªèˆªç©ºå…¬å¸

```bash
# æŠ“å– American Airlines çš„åº§ä½å›¾
python main.py --airline AA

# æŠ“å– Delta Airlines çš„åº§ä½å›¾å¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
python main.py --airline DL --verbose

# æŠ“å– United Airlines çš„åº§ä½å›¾åˆ°æŒ‡å®šç›®å½•
python main.py --airline UA --output-dir ./my_data
```

**è¾“å‡ºè¯´æ˜ï¼š**
- åº§ä½å›¾å›¾ç‰‡ä¿å­˜åˆ° `data/seatmaps/AA/` ç›®å½•
- ç»“æ„åŒ–æ•°æ®å†™å…¥ `data/seatmaps.db`ï¼ˆSQLiteï¼‰ä¸ `data/results.jsonl`ï¼ˆJSON Linesï¼‰
- æ˜¾ç¤ºæŠ“å–è¿›åº¦å’Œç»Ÿè®¡ä¿¡æ¯

### 2. æŠ“å–æ‰€æœ‰èˆªç©ºå…¬å¸

```bash
# æŠ“å–æ‰€æœ‰æ”¯æŒçš„èˆªç©ºå…¬å¸
python main.py --all-airlines

# æŠ“å–æ‰€æœ‰èˆªç©ºå…¬å¸å¹¶æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
python main.py --all-airlines --stats --verbose
```

**è¾“å‡ºè¯´æ˜ï¼š**
- ä¾æ¬¡æŠ“å–æ‰€æœ‰æ”¯æŒçš„èˆªç©ºå…¬å¸åº§ä½å›¾
- æ¯ä¸ªèˆªç©ºå…¬å¸ç”Ÿæˆç‹¬ç«‹çš„å›¾ç‰‡ç›®å½•ï¼›ç»“æ„åŒ–æ•°æ®ç»Ÿä¸€å†™å…¥ `seatmaps.db` ä¸ `results.jsonl`
- æ˜¾ç¤ºæ€»ä½“æŠ“å–ç»Ÿè®¡ä¿¡æ¯

### 3. æŸ¥çœ‹æ”¯æŒçš„èˆªç©ºå…¬å¸

```bash
# åˆ—å‡ºæ‰€æœ‰æ”¯æŒçš„èˆªç©ºå…¬å¸ä»£ç 
python main.py --list-airlines
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
æ”¯æŒçš„èˆªç©ºå…¬å¸ä»£ç ï¼š
AA - American Airlines
DL - Delta Air Lines
UA - United Airlines
WN - Southwest Airlines
AS - Alaska Airlines
...
```

## è¾“å‡ºç»“æ„è¯¦è§£

### ç›®å½•ç»“æ„

```
data/
â”œâ”€â”€ seatmaps/                 # åº§ä½å›¾å›¾ç‰‡æ ¹ç›®å½•
â”‚   â”œâ”€â”€ AA/                  # American Airlines å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ boeing-737-800/  # æŒ‰æœºå‹åˆ†ç±»
â”‚   â”‚   â”œâ”€â”€ airbus-a320/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ DL/                  # Delta Airlines å›¾ç‰‡
â”‚   â””â”€â”€ ...
â”œâ”€â”€ seatmaps.db              # ç»“æ„åŒ–æ•°æ®ï¼ˆSQLite æ•°æ®åº“ï¼‰
â”œâ”€â”€ results.jsonl            # ç»“æ„åŒ–æ•°æ®ï¼ˆJSON Linesï¼Œæ¯è¡Œä¸€ä¸ª JSON å¯¹è±¡ï¼‰
â””â”€â”€ crawler_log.txt          # æŠ“å–æ—¥å¿—æ–‡ä»¶
```

### æ•°æ®å­˜å‚¨æ ¼å¼

å½“å‰ç‰ˆæœ¬æ”¯æŒä¸¤ç§ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼ŒäºŒè€…å¯åŒæ—¶ç”Ÿæˆï¼š

1) SQLite æ•°æ®åº“ï¼ˆ`seatmaps.db`ï¼‰
- ç”¨äºé«˜æ•ˆæŸ¥è¯¢ä¸ç»Ÿè®¡ï¼ˆå¦‚ CLI `--stats` çš„è®°å½•æ•°ç»Ÿè®¡ï¼‰
- ä¸»è¦è¡¨ï¼š`seatmaps`ï¼ˆåŒ…å«åº§ä½å›¾çš„ç»“æ„åŒ–ä¿¡æ¯ï¼‰
- å…¸å‹å­—æ®µï¼š`airline_code`ã€`airline_name`ã€`aircraft_model`ã€`seatmap_url`ã€`image_filename`ã€`downloaded_at`ã€`file_size_bytes`

2) JSON Linesï¼ˆ`results.jsonl`ï¼‰
- æ¯è¡Œä¸€ä¸ª JSON å¯¹è±¡ï¼Œä¾¿äºæµå¼å¤„ç†ä¸è¿½è¸ªæŠ“å–è¿‡ç¨‹
- å…¸å‹è®°å½•ç¤ºä¾‹ï¼š

```json
{"airline_code":"AA","aircraft_model":"Boeing 737-800","seatmap_url":"https://...","image_filename":"boeing-737-800_001.jpg","downloaded_at":"2024-01-20T10:30:45Z","file_size_bytes":245760}
```

æç¤ºï¼šå†å² CSV å¯¼å‡ºå·²å–æ¶ˆï¼Œä¸å†ç”Ÿæˆæ–°çš„ CSV æ–‡ä»¶ï¼›å·²æœ‰å†å² CSV æ–‡ä»¶æ— éœ€è¿ç§»ï¼Œä»å¯æŒ‰éœ€ä¿ç•™ã€‚

## é«˜çº§åŠŸèƒ½

### 1. è‡ªå®šä¹‰é…ç½®

æ‚¨å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶è‡ªå®šä¹‰çˆ¬è™«è¡Œä¸ºï¼š

```bash
# è®¾ç½®è¯·æ±‚å»¶è¿Ÿï¼ˆç§’ï¼‰
export AEROLOPA_DELAY=2

# è®¾ç½®æœ€å¤§é‡è¯•æ¬¡æ•°
export AEROLOPA_MAX_RETRIES=3

# è®¾ç½®è¾“å‡ºç›®å½•
export AEROLOPA_OUTPUT_DIR=./custom_output
```

### 2. é”™è¯¯å¤„ç†

çˆ¬è™«å…·æœ‰å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š

- **ç½‘ç»œé”™è¯¯**ï¼šè‡ªåŠ¨é‡è¯•ï¼Œæœ€å¤šé‡è¯•3æ¬¡
- **è§£æé”™è¯¯**ï¼šè·³è¿‡æœ‰é—®é¢˜çš„é¡µé¢ï¼Œç»§ç»­å¤„ç†å…¶ä»–é¡µé¢
- **æ–‡ä»¶é”™è¯¯**ï¼šè‡ªåŠ¨åˆ›å»ºå¿…è¦çš„ç›®å½•ç»“æ„

### 3. è¿›åº¦ç›‘æ§

ä½¿ç”¨ `--verbose` é€‰é¡¹å¯ä»¥æŸ¥çœ‹è¯¦ç»†çš„æŠ“å–è¿›åº¦ï¼š

```bash
python main.py --airline AA --verbose
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
[INFO] å¼€å§‹æŠ“å– American Airlines (AA)
[INFO] å‘ç° 25 ä¸ªé£æœºå‹å·
[INFO] æ­£åœ¨å¤„ç†: Boeing 737-800 (1/25)
[INFO] ä¸‹è½½å›¾ç‰‡: boeing-737-800_001.jpg
[INFO] å¤„ç†å®Œæˆ: Boeing 737-800
...
[INFO] æŠ“å–å®Œæˆï¼å…±å¤„ç† 25 ä¸ªå‹å·ï¼Œä¸‹è½½ 156 å¼ å›¾ç‰‡
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç½‘ç»œè¿æ¥é—®é¢˜**
   ```bash
   # å¢åŠ é‡è¯•æ¬¡æ•°å’Œå»¶è¿Ÿ
   python main.py --airline AA --verbose
   ```

2. **æƒé™é—®é¢˜**
   ```bash
   # ç¡®ä¿è¾“å‡ºç›®å½•æœ‰å†™æƒé™
   chmod 755 data/
   ```

3. **ä¾èµ–ç¼ºå¤±**
   ```bash
   # é‡æ–°å®‰è£…ä¾èµ–
   pip install -r requirements.txt
   ```

### æ—¥å¿—æ–‡ä»¶

è¯¦ç»†çš„è¿è¡Œæ—¥å¿—ä¿å­˜åœ¨ `data/crawler_log.txt` æ–‡ä»¶ä¸­ï¼ŒåŒ…å«ï¼š
- æŠ“å–å¼€å§‹å’Œç»“æŸæ—¶é—´
- å¤„ç†çš„URLåˆ—è¡¨
- é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯
- æ€§èƒ½ç»Ÿè®¡æ•°æ®

## æ€§èƒ½ä¼˜åŒ–

### 1. å¹¶å‘æ§åˆ¶

ä¸ºé¿å…å¯¹ç›®æ ‡ç½‘ç«™é€ æˆè¿‡å¤§å‹åŠ›ï¼Œçˆ¬è™«é»˜è®¤ä½¿ç”¨é€‚å½“çš„å»¶è¿Ÿï¼š
- é¡µé¢è¯·æ±‚é—´éš”ï¼š1-2ç§’
- å›¾ç‰‡ä¸‹è½½é—´éš”ï¼š0.5-1ç§’

### 2. å†…å­˜ä½¿ç”¨

å¯¹äºå¤§è§„æ¨¡æŠ“å–ï¼Œå»ºè®®ï¼š
- åˆ†æ‰¹å¤„ç†èˆªç©ºå…¬å¸
- å®šæœŸæ¸…ç†ä¸´æ—¶æ–‡ä»¶
- ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ

### 3. å­˜å‚¨ç©ºé—´

é¢„ä¼°å­˜å‚¨éœ€æ±‚ï¼š
- å•ä¸ªèˆªç©ºå…¬å¸ï¼š50-200MB
- æ‰€æœ‰èˆªç©ºå…¬å¸ï¼š2-5GB

## é›†æˆç¤ºä¾‹

### 1. å®šæ—¶ä»»åŠ¡

```bash
#!/bin/bash
# æ¯æ—¥æ›´æ–°è„šæœ¬
cd /path/to/aerolopaCrawler
source .venv/bin/activate
python main.py --all-airlines --stats > daily_update.log 2>&1
```

### 2. Python è„šæœ¬é›†æˆ

```python
import subprocess
import sys

def crawl_airline(airline_code):
    """æŠ“å–æŒ‡å®šèˆªç©ºå…¬å¸æ•°æ®"""
    cmd = [sys.executable, 'main.py', '--airline', airline_code]
    result = subprocess.run(cmd, capture_output=True, text=True)
    return result.returncode == 0

# ä½¿ç”¨ç¤ºä¾‹
if crawl_airline('AA'):
    print("American Airlines æ•°æ®æŠ“å–æˆåŠŸ")
else:
    print("æŠ“å–å¤±è´¥")
```

## æ›´å¤šä¿¡æ¯

- **API æœåŠ¡æ¨¡å¼**ï¼šå‚è§ [API_USAGE.md](API_USAGE.md)
- **å¼€å‘æŒ‡å—**ï¼šå‚è§ [DEVELOPMENT.md](DEVELOPMENT.md)
- **æµ‹è¯•æŒ‡å—**ï¼šå‚è§ [TESTING.md](TESTING.md)
